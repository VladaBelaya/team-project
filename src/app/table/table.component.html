<mat-form-field appearance="outline">
  <mat-label>Enter a date range</mat-label>
  <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
    <input matStartDate formControlName="start" placeholder="Start date" />
    <input matEndDate formControlName="end" placeholder="End date" />
  </mat-date-range-input>
  <mat-hint>MM/DD/YYYY â€“ MM/DD/YYYY</mat-hint>
  <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
  <mat-date-range-picker #picker></mat-date-range-picker>

  <mat-error *ngIf="range.controls.start.hasError('matStartDateInvalid')"
    >Invalid start date</mat-error
  >
  <mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')"
    >Invalid end date</mat-error
  >
</mat-form-field>
<button mat-button>Update</button>

<p>Selected range: {{ range.value | json }}</p>

<table
  mat-table
  [dataSource]="officeData"
  multiTemplateDataRows
  class="mat-elevation-z8 outer-table">
  <ng-container
    matColumnDef="{{ column.id }}"
    *ngFor="let column of columnsToDisplay">
    <th mat-header-cell *matHeaderCellDef>{{ column.name }}</th>
    <td mat-cell *matCellDef="let element">{{ element[column.id] }}</td>
  </ng-container>
  <ng-container matColumnDef="expand">
    <th mat-header-cell *matHeaderCellDef aria-label="row actions">&nbsp;</th>
    <td mat-cell *matCellDef="let element">
      <button
        mat-icon-button
        aria-label="expand row"
        (click)="
          expandedOffice === element
            ? clearStorages()
            : getStorages(element.office_id);
          expandedOffice = expandedOffice === element ? null : element;
          $event.stopPropagation()
        ">
        <mat-icon *ngIf="expandedOffice !== element"
          >keyboard_arrow_down</mat-icon
        >
        <mat-icon *ngIf="expandedOffice === element"
          >keyboard_arrow_up</mat-icon
        >
      </button>
    </td>
  </ng-container>

  <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
  <ng-container matColumnDef="expandedDetail">
    <td
      mat-cell
      *matCellDef="let element"
      [attr.colspan]="columnsToDisplayWithExpand.length">
      <div
        class="example-element-detail"
        [@detailExpand]="element == expandedOffice ? 'expanded' : 'collapsed'">
        <table
          mat-table
          [dataSource]="storageData"
          multiTemplateDataRows
          class="mat-elevation-z8">
          <ng-container
            matColumnDef="{{ column.id }}"
            *ngFor="let column of columnsToDisplay">
            <th mat-header-cell *matHeaderCellDef>{{ column.name }}</th>
            <td mat-cell *matCellDef="let element">{{ element[column.id] }}</td>
          </ng-container>
          <ng-container matColumnDef="expand">
            <th mat-header-cell *matHeaderCellDef aria-label="row actions">
              &nbsp;
            </th>
            <td mat-cell *matCellDef="let element">
              <button
                mat-icon-button
                aria-label="expand row"
                (click)="
                  expandedStorage === element
                    ? clearDatesAndQuantities()
                    : getDatesAndQuantities(element.wh_id);
                  expandedStorage =
                    expandedStorage === element ? null : element;
                  $event.stopPropagation()
                ">
                <mat-icon *ngIf="expandedStorage !== element"
                  >keyboard_arrow_down</mat-icon
                >
                <mat-icon *ngIf="expandedStorage === element"
                  >keyboard_arrow_up</mat-icon
                >
              </button>
            </td>
          </ng-container>

          <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
          <ng-container matColumnDef="expandedDetail">
            <td
              mat-cell
              *matCellDef="let element"
              [attr.colspan]="columnsToDisplayWithExpand.length">
              <div
                class="example-element-detail"
                [@detailExpand]="
                  element == expandedStorage ? 'expanded' : 'collapsed'
                ">
                <table
                  mat-table
                  [dataSource]="datesAndQuantitiesData"
                  multiTemplateDataRows
                  class="mat-elevation-z8">
                  <ng-container
                    matColumnDef="{{ column.id }}"
                    *ngFor="let column of columnsToDisplay">
                    <th mat-header-cell *matHeaderCellDef>{{ column.name }}</th>
                    <td mat-cell *matCellDef="let element">
                      {{ element[column.id] }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="expand">
                    <th
                      mat-header-cell
                      *matHeaderCellDef
                      aria-label="row actions">
                      &nbsp;
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <button
                        mat-icon-button
                        aria-label="expand row"
                        (click)="
                          openChart(element.wh_id); $event.stopPropagation()
                        ">
                        <mat-icon>show_chart</mat-icon>
                      </button>
                    </td>
                  </ng-container>

                  <tr
                    mat-row
                    *matRowDef="
                      let element;
                      columns: columnsToDisplayWithExpand
                    "
                    class="example-element-row"
                    [class.example-expanded-row]="expandedStorage === element"
                    (click)="
                      expandedStorage =
                        expandedStorage === element ? null : element
                    "></tr>
                </table>
              </div>
            </td>
          </ng-container>

          <tr
            mat-row
            *matRowDef="let element; columns: columnsToDisplayWithExpand"
            class="example-element-row"
            [class.example-expanded-row]="expandedStorage === element"
            (click)="
              expandedStorage = expandedStorage === element ? null : element
            "></tr>
          <tr
            mat-row
            *matRowDef="let row; columns: ['expandedDetail']"
            class="example-detail-row"></tr>
        </table>
      </div>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="columnsToDisplayWithExpand"></tr>
  <tr
    mat-row
    *matRowDef="let element; columns: columnsToDisplayWithExpand"
    class="example-element-row"
    [class.example-expanded-row]="expandedOffice === element"
    (click)="expandedOffice = expandedOffice === element ? null : element"></tr>
  <tr
    mat-row
    *matRowDef="let row; columns: ['expandedDetail']"
    class="example-detail-row"></tr>
</table>
